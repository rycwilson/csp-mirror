
<div class="form-group">
  <%= f.label(:video_url, 'Video URL') %>
  <%= f.text_field(:video_url, class: 'form-control',
        placeholder: 'YouTube, Vimeo, or Wistia') %>
  <%= hidden_field_tag('story[formatted_video_url]') %>
</div>

<div class="video-container text-center" style='border:1px solid #ccc;border-radius:4px;overflow:hidden'
       data-placeholder="<%= asset_path('video_placeholder.jpg') %>">

  <% if story.video_info[:provider] == 'wistia' %>

    <script src="//fast.wistia.com/embed/medias/<%= story.video_info[:id] %>.jsonp" async></script>
    <script src="//fast.wistia.com/assets/external/E-v1.js" async></script>
    <div class="wistia_responsive_padding"
         style="padding:56.25% 0 0 0; position:relative;">
      <div class="wistia_responsive_wrapper"
           style="height:100%;left:0;position:absolute;top:0;width:100%;">
        <div class="wistia_embed wistia_async_<%= story.video_info[:id] %>
              popover=true popoverAnimateThumbnail=true videoFoam=true"
             style="display:inline-block; width:100%; height:100%">&nbsp;
        </div>
      </div>
    </div>

  <% elsif story.video_url.present? %>

    <div class="video-thumb-container"
         data-toggle='modal' data-target='#story-video-modal'
         data-provider="<%= story.video_info[:provider] %>"
         data-video-id="<%= story.video_info[:id] %>"
         data-video-url="<%= story.video_url %>">
    </div>

  <% else %>

    <img id='video-placeholder' src="<%= asset_path('video_placeholder.jpg') %>"
         class="<%= story.video_url.present? ? 'hidden' : '' %>" alt="video placeholder">

  <% end %>

</div>

<% content_for(:underscore_templates) do %>

  <script type='text/template' id='video-template'>

    {{ if (provider === 'wistia') { }}

      <div class="wistia_responsive_padding"
           style="padding:56.25% 0 0 0; position:relative;">
        <div class="wistia_responsive_wrapper"
             style="height:100%;left:0;position:absolute;top:0;width:100%;">
          <div class="wistia_embed wistia_async_{{= videoId }}
                popover=true popoverAnimateThumbnail=true videoFoam=true"
               style="display:inline-block; width:100%; height:100%">&nbsp;
          </div>
        </div>
      </div>

    {{ } else { }}

      <div class="video-thumb-container"
           data-toggle='modal' data-target='#story-video-modal'
           data-provider="{{= provider }}"
           data-video-id="{{= videoId }}"
           data-video-url="{{= videoUrl }}">
      </div>

    {{ } }}

  </script>

<% end %>