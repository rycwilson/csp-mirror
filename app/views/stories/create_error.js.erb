(function () {

  var flashMesg = <%= raw @flash_mesg.to_json %>

  $('#new-story-modal').modal('hide');

  flashDisplay(flashMesg);

  function flashDisplay (mesg) {

    $('#flash').toggleClass('hidden alert-danger').append(mesg);
    $('#flash').hide().append(flash).fadeIn('fast');

    setTimeout(function () {
      $('#flash').slideUp();
    }, 4000);

    setTimeout(function () {
      $('#flash').toggleClass('hidden alert-danger')
      // dispay:none setting appears after first click-cycle,
      // leads to subsequent failures
      // solution...
      $('#flash').css('display', '');
      // remove all text, leave child elements
      $('#flash').html($('#flash').children());
    }, 5000);
  }

})();
