<%= render 'stories/shared/new_contributor_modal' %>

<div class='container'>

  <!-- nav back to Curate -->
  <%= link_to company_path(current_user.company), class: 'story-nav' do %>
    <span class='glyphicon glyphicon-chevron-left'
        style='color:#337ab7; margin-top:20px; margin-right:5px'>
    </span><span>Curate Stories</span>
  <% end %>
  <hr>

  <!-- settings, title, quote, video -->
  <div class='row' style='margin-top:15px'>

    <div class='col-md-4'>  <!-- story settings -->

      <p class='lead'>Story Settings</p>
      <%= render 'stories/shared/story_edit_settings.html.erb' %>

    </div>  <!-- story settings -->

    <!-- title and quote -->
    <div class="col-md-4">

      <p class='lead'>Title</p>
      <%= render 'stories/shared/story_edit_title' %>

      <p class='lead'>Customer Quote</p>
      <%= render 'stories/shared/story_edit_customer_quote' %>

    </div>  <!-- title and quote -->

    <!-- video -->
    <div class='col-md-4'>

      <p class='lead'>Video</p>
      <%= render 'stories/shared/story_edit_video' %>

    </div>  <!-- video -->

  </div>  <!-- settings, title, quote, video -->

  <!-- tags -->
  <p class='lead' style='display:inline-block'>Tags</p>
  <button type='submit' class='edit-tags hidden btn btn-sm btn-primary'
      style='display:inline-block; margin-left:15px; margin-bottom:8px' form='tags-form'>
    Save changes
  </button>
  <button id='edit-tags-cancel' class='edit-tags hidden btn btn-sm btn-default'
      style='display:inline-block; margin-bottom:8px'>
    Cancel
  </button>  <!-- tags -->

  <!-- tags form -->
  <div class="row" style='margin-bottom: 15px'>
    <div class="col-md-12">
      <div class="well">
        <div class="container-fluid">

          <%= render 'stories/shared/story_edit_tags_form' %>

        </div>
      </div>
    </div>
  </div>  <!-- tags form -->


  <div class="row">
    <div class="col-md-6">
      <p class='lead'>Contributions</p>
    </div>
    <div class="col-md-6">
      <p class='lead'>Story Narration</p>
    </div>
  </div>

  <div class="row">  <!-- content -->

    <!-- <div class="layout layout-main-right layout-stack-sm"> -->

      <!-- Contributors nav -->
      <div class="col-md-2 col-sm-4 layout-sidebar" style='padding-top:0'>

        <ul id="contributions-nav" class="nav nav-layout-sidebar nav-stacked">

          <li class="active">
            <a href="#pre-request" data-toggle="tab">
              <i class="fa fa-play-circle"></i>
              &nbsp;&nbsp;Contributors
            </a>
          </li>

          <li>
            <a href="#in-progress" data-toggle="tab">
              <i class="fa fa-line-chart"></i>
              &nbsp;&nbsp;Progress
            </a>
          </li>

          <li>
            <a href="#feedback" data-toggle="tab">
              <i class="fa fa-comment-o"></i>
              &nbsp;&nbsp;Feedback
            </a>
          </li>

          <li>
            <a href="#contributions" data-toggle="tab">
              <i class="fa fa-users"></i>
              &nbsp;&nbsp;Contributions
            </a>
          </li>

          <li>
            <a href="#connections" data-toggle="tab">
              <i class="fa fa-linkedin-square"></i>
              &nbsp;&nbsp;Connections
            </a>
          </li>

        </ul>
      </div> <!-- .col-md-2 contributions navigation -->

      <!-- Contributors list -->
      <div class="col-md-4 col-sm-8 layout-main" style='padding-top:0'>
      <hr style='margin-top:0'>

        <div class="tab-content stacked-content">

          <%= render 'stories/shared/story_edit_pre_request_contributions' %>

          <%= render 'stories/shared/story_edit_in_progress_contributions' %>

          <%= render 'stories/shared/story_edit_feedback_contributions' %>

          <%= render 'stories/shared/story_edit_contribution_contributions' %>

          <%= render 'stories/shared/story_edit_connection_contributions' %>

        </div> <!-- tab-content -->

      </div>  <!-- Contributors list -->

      <!-- Story content -->
      <div class='col-md-6'>
        <!-- <p class='lead'>Story Narration</p> -->
        <div class="well" style='position:relative'>
          <div class="container-fluid">

            <div class="row" style='margin-top:10px'>

              <div id='edit-story-situation'
                    style='position:absolute; right:20px; margin-top:-3px'>
                  <span class='glyphicon glyphicon-pencil bip-clickable'></span>
              </div>

              <div class='col-md-11' id='story-situation'>
                <strong>Situation:&nbsp&nbsp</strong>
                <%= best_in_place @story, :situation, as: :textarea, url: story_path(@story),
                    activator: '#edit-story-situation',
                    place_holder: 'Add story situation ...',
                    html_attrs: { style: 'width:100%' } %>
              </div>

            </div> <br>

            <div class="row">

              <div id='edit-story-challenge'
                    style='position:absolute; right:20px; margin-top:-3px'>
                  <span class='glyphicon glyphicon-pencil bip-clickable'></span>
              </div>

              <div class='col-md-11' id='story-challenge'>
                <strong>Challenge:&nbsp&nbsp</strong>
                <%= best_in_place @story, :challenge, as: :textarea, url: story_path(@story),
                    activator: '#edit-story-challenge',
                    place_holder: 'Add story challenge ...',
                    html_attrs: { style: 'width:100%' } %>

              </div>
            </div> <br>

            <div class="row">

              <div id='edit-story-solution'
                    style='position:absolute; right:20px; margin-top:-3px'>
                  <span class='glyphicon glyphicon-pencil bip-clickable'></span>
              </div>

              <div class='col-md-11' id='story-solution'>
                <strong>Solution:&nbsp&nbsp</strong>
                <%= best_in_place @story, :solution, as: :textarea, url: story_path(@story),
                    activator: '#edit-story-solution',
                    place_holder: 'Add story solution ...',
                    html_attrs: { style: 'width:100%' } %>

              </div>
            </div> <br>

            <div class="row">

              <div id='edit-story-results'
                    style='position:absolute; right:20px; margin-top:-3px'>
                  <span class='glyphicon glyphicon-pencil bip-clickable'></span>
              </div>

              <div class='col-md-11' id='story-results'>
                <strong>Results:&nbsp&nbsp</strong>
                <%= best_in_place @story, :results, as: :textarea, url: story_path(@story),
                    activator: '#edit-story-results',
                    place_holder: 'Add story results ...',
                    html_attrs: { style: 'width:100%' } %>

              </div>

            </div>  <!-- row -->
          </div>
        </div>  <!-- well -->
      </div>  <!-- col-md-6 Story content -->

    <!-- </div>  --> <!-- layout -->

  </div>  <!-- row -->
</div>  <!-- container -->

<!-- pre-request template -->
<script type="text/template" id="pre-request-template">
  {{ contributors.forEach(function (contributor) { }}
    <div class="well" data-contribution-id="{{= contributor.contribution_id }}">
      <div class="row">
        <div class='col-sm-7'>
          {{= contributor.full_name }} <br>
          {{= contributor.email }} <br>
          {{= contributor.role }}
        </div>
        <div class='col-sm-5 text-right'>
          <form class="button_to" method="post"
              action="/contributions/{{= contributor.contribution_id }}/request_contribution"
              data-remote="true">
            <input type="hidden" name="_method" value="put">
            <input class="btn btn-sm btn-secondary" type="submit"
                    value="Send Request">
          </form>
        </div>
      </div>
      {{ if (contributor.referrer) { }}
        <br>
        <div class="row">
          <div class="col-sm-12">
            Referred by {{= contributor.referrer }}
          </div>
        </div>
      {{ } }}
    </div>
  {{ }); }}
</script>

<!-- in-progress template -->
<script type="text/template" id="in-progress-template">
  <div class="well" data-contribution-id="{{= contributor.contributionId }}">
    <div class="row">
      <div class='col-md-12'>
        {{= contributor.fullName }} <br>
        {{= contributor.email }} <br>
        {{= contributor.role }} <br><br>
        {{= contributor.contributionStatus }}
      </div>
    </div>
  </div>
</script>



