
(function () {

  var storyIds = <%= raw @story_ids.to_json %>,
      searchString = "<%= @search_string %>",
      searchResults = storyIds.length === 1 ? "1 story found" : storyIds.length.toString() + " stories found";

  if (storyIds.length === 0) {
    $('#stories-gallery')
      .empty()
      .append('<li><h4 id="no-search-results">Sorry, we couldn\'t find any results matching "' + searchString + '"</h4></li>');
  } else {
    updateGallery($(
      _.template($('#stories-template').html())({
        stories: CSP.stories.filter(function (story) { return storyIds.includes(story.id); }),
        isCurator: false
      })
    ));
  }

  $('.clear-search').show();
  // don't show search results for stories-header
  $('.filters-container .search-results').text(searchResults).show();
  $('.filters-container.tall .combined-results > span').hide();
  $('.filter-results > span').text('');
  $('.stories-filter').val('').trigger('change.select2');
  $('#grouped-stories-filter').val(null).trigger('change.select2');

}());