(function () {

  var prompts = <%= raw @prompts.to_json %>,
      storyId = <%= raw @story_id.to_json %>,
      baseUrl = <%= raw @base_url.to_json %>,
     template = _.template($('#prompts-template').html());

  $('#prompts-list').empty();

  prompts.forEach(function (prompt, index) {
    $('#prompts-list').append(template({ prompt: prompt,
                                          index: index,
                                        storyId: storyId,
                                        baseUrl: baseUrl }));
  });

  // dynamiclly added elements must be reset as bip elements
  $('.best_in_place').best_in_place();
  $('#new-prompt').val('');
  $('#new-prompt').parent().find('button').blur();

}());