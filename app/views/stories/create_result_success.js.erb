(function () {

  var results = <%= raw @results.to_json %>,
      storyId = <%= raw @story_id.to_json %>,
      baseUrl = <%= raw @base_url.to_json %>,
     template = _.template($('#results-template').html());

  $('#results-list').empty();

  results.forEach(function (result, index) {
    $('#results-list').append(template({ result: result,
                                          index: index,
                                        storyId: storyId,
                                        baseUrl: baseUrl }));
  });

  // dynamiclly added elements must be reset as bip elements
  $('.best_in_place').best_in_place();
  $('#new-result').val('');
  $('#new-result').parent().find('button').blur();

})();