<!--
  locals: @story
          @story_has_video (boolean)
-->

<!--
  data-no-turbolink attribute is necessary for linkedin widgets
  to properly load
  http://stackoverflow.com/questions/17600093/rails-javascript-not-loading-after-clicking-through-link-to-helper
-->
<div id='story-nav-col' class="col-xs-12">

  <div data-no-turbolink class='story-nav'>
    <%= render 'stories/shared/story_nav' %>
  </div>

</div>

<div id='story-testimonial-col'
    class="col-xs-12 <%= story_has_video ? 'col-sm-6 col-md-7' : 'no-video' %>">

  <!-- logo -->
  <div id='story-customer-logo-col'
       class='text-center col-xs-3
             <%= story_has_video ? 'col-sm-12' : '' %>'>
    <img id='story-customer-logo'
      src="<%= story.success.customer.logo_url || asset_path('company-logo-missing.png') %>">
  </div>

  <!-- quote -->
  <div id='story-quote-col'
       class='story-text col-xs-9
              <%= story_has_video ? 'col-sm-12' : '' %> '>
    <p id='story-quote' class='lead story-text'>
      <em>"<%= story.quote %>"</em>
    </p>

    <div id='story-quote-attr-col'
         class='col-sm-12 col-lg-11 text-right hidden-xs'>
      <p id='story-quote-attr'>
        &#8211;&nbsp;<%= story.quote_attr %>
      </p>
    </div>

    <div id='story-quote-attr-col'
         class='col-xs-12 visible-xs'>
      <p id='story-quote-attr'>
        &#8211;&nbsp;<%= story.quote_attr.gsub(',', ",<br>&nbsp;&nbsp;").html_safe %>
      </p>
    </div>

  </div>
</div>

<div id='story-video-col'
     class="<%= story_has_video ? 'hidden-xs col-sm-6 col-md-5' : 'hidden' %>">

  <!-- <div itemprop='video' itemscope itemtype='//schema.org/VideoObject'> -->
    <!-- <meta itemprop='' content='' -->

    <% if story.video_info[:provider] == 'wistia' %>

      <script src="//fast.wistia.com/embed/medias/<%= story.video_info[:id] %>.jsonp" async></script>
      <script src="//fast.wistia.com/assets/external/E-v1.js" async></script>
      <div class="wistia_responsive_padding"
           style="padding:56.25% 0 0 0; position:relative;">
        <div class="wistia_responsive_wrapper"
             style="height:100%;left:0;position:absolute;top:0;width:100%;">
          <div class="wistia_embed wistia_async_<%= story.video_info[:id] %>
                popover=true popoverAnimateThumbnail=true videoFoam=true"
               style="display:inline-block; width:100%; height:100%">&nbsp;
          </div>
        </div>
      </div>

    <% else %>

        <div class="video-thumb-container"
             data-toggle='modal' data-target='#story-video-modal'
             data-provider="<%= story.video_info[:provider] %>"
             data-video-id="<%= story.video_info[:id] %>"
             data-video-url="<%= story.embed_url %>">
        </div>

    <% end %>

  <!-- </div> -->  <!-- meta VideoObject -->
</div>



