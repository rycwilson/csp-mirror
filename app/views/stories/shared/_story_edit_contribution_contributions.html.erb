
<div class="tab-pane fade" id="contributions">

  <div class="heading-block">
    <h4>Successful Contribution</h4>
  </div> <!-- /.heading-block -->

  <div id='contribution-contributors'>

    <% @contributions.select { |c| c.status == 'contribution' }
        .each_with_index do |contribution, index| %>

      <div class="well contribution-card accordion"
          id="contribution-accordian-<%= index %>"
          data-contribution-id="<%= contribution.id %>">

        <div class="row">
          <div class='col-sm-7'>
            <%= contribution.contributor.full_name %> <br>
            <%= contribution.contributor.email %>
          </div>
          <div class="col-sm-5 text-right">
            <a class="accordion-toggle" data-toggle="collapse"
               data-parent="#contribution-accordion-<%= index %>"
               href="#collapse-contribution-read-<%= index %>" tabindex='-1'>
              <span class='glyphicon glyphicon-comment bip-clickable'></span></a>

            <a class="accordion-toggle" data-toggle="collapse"
               data-parent="#contribution-accordion-<%= index %>"
               href="#collapse-contribution-info-<%= index %>" tabindex='-1'>
              <span class='glyphicon glyphicon-info-sign bip-clickable'></span></a>

            <a target="_blank" tabindex='-1' href="http://google.com/search?q=
              <%= contribution.role == 'customer' ?
                  research_user_query_string(contribution.contributor,
                    @story.success.customer) :
                  research_user_query_string(contribution.contributor) %>">
              <span class='glyphicon glyphicon-user bip-clickable'></span></a>
          </div>
        </div>

        <div class="row">
          <div class="col-sm-12">

            <div id="collapse-contribution-read-<%= index %>" class="accordion-body collapse">
              <div class="accordion-inner">
                <hr>
                <div>"<%= contribution.contribution %>"</div>
              </div>
            </div>

            <div id="collapse-contribution-info-<%= index %>" class="accordion-body collapse">
              <div class="accordion-inner">
                <hr>

                Role:&nbsp;&nbsp;<%= contribution.role %> <br style='line-height:20px'>
                Referred by:&nbsp;&nbsp;<%= contribution.referrer_id.present? ? contribution.referrer.full_name : "n/a" %> <br style='line-height:20px'>
                Received:&nbsp;&nbsp;<%= contribution.updated_at.strftime('%-m/%-d/%Y') %> <br style='line-height:20px'>
                Notes: <br style='line-height:20px'>

                <div class="row">

                  <div id='edit-contribution-notes-<%= index %>'
                      class='col-sm-2 text-center pull-right'
                      style='padding:0; margin-top:-2px'>
                    <span class='glyphicon glyphicon-pencil bip-clickable'></span>
                  </div>

                  <div id='contribution-notes-<%= index %>' class='col-sm-10'
                      style='padding-right:0'>
                    <%= best_in_place contribution, :notes, as: :textarea,
                              url: "/contributions/#{contribution.access_token}",
                       html_attrs: { style:'width:100%' },
                        activator: "#edit-contribution-notes-#{index}",
                     place_holder: "<i>add notes ...</i>" %>
                  </div>

                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

    <% end %>

  </div>  <!-- contribution contributors -->
</div>  <!-- contributions