
<form>
  <div class="form-group">

    <% if include_category_filter?(company) && include_product_filter?(company) %>

      <%= label_tag(:filter_select, "Filter") %>
      <%= select_tag(:filter_select,
            grouped_options_for_select(
              company.stories_filter_public_grouped_options,
              [
                pre_selected_filters['category'].present? ? "c#{pre_selected_filters['category']}" : '',
                pre_selected_filters['product'].present? ? "p#{pre_selected_filters['product']}" : ''
              ].delete_if { |item| item.blank? }
            ),
            {
              include_blank: true,
              id: 'grouped-stories-filter',
              multiple: true,
              class: 'form-control',
              style: 'width: 100%'
            }
          ) %>

    <% elsif include_category_filter?(company) %>

      <%= label_tag(:category_select, "Category") %>
      <%= select_tag(:category_select,
            options_for_select(
              company.story_categories.public_select_options,
              pre_selected_filters['category'].present? ? pre_selected_filters['category'] : ''
            ),
            {
              include_blank: true,
              class: 'stories-filter category-select form-control',
              style: 'width: 100%'
            }
          ) %>

    <% else %>

      <%= label_tag(:product_select, "Product") %>
      <%= select_tag(:product_select,
            options_for_select(
              company.products.public_select_options,
              pre_selected_filters['product'].present? ? [pre_selected_filters['product']] : []
            ),
            {
              include_blank: true,
              class: 'stories-filter product-select form-control',
              style: 'width: 100%'
            }
          ) %>

    <% end %>

    <div class="filter-results text-right">
      <span>

        <% if pre_selected_filters['category'].present? && pre_selected_filters['product'].present? %>
          <%= applied_filters_results %>
        <% elsif pre_selected_filters['category'].present? %>
          <%= category_results %>
        <% else %>
          <%= product_results %>
        <% end %>

      </span>
    </div>

  </div>
</form>