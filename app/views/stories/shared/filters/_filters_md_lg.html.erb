
<div class="filters-container visible-md-block visible-lg-block <%= include_category_filter?(company) && include_product_filter?(company) ? 'tall' : 'short' %>">

  <%= render('stories/shared/filters/search_form', { company: company }) %>

  <div class="combined-results text-right" style="height: 18px; margin-bottom: 10px;">
    <span style="<%= pre_selected_filters['category'].present? || pre_selected_filters['product'].present? ? 'display: inline' : 'display: none' %>">
      <span style="font-weight: 600">Applied filters:&nbsp;&nbsp;</span>
      <span><%= "#{pluralize(stories.length, 'story', 'stories')} found" %></span>
    </span>
  </div>

  <% if include_category_filter?(company) %>

    <% cache(category_select_cache_key, skip_digest: true) do %>

      <div class="form-group">

        <%= label_tag(:category_select, "Category") %>
        <%= select_tag(:category_select,
              options_for_select(
                company.story_categories.public_select_options,
                pre_selected_filters['category'].present? ? pre_selected_filters['category'] : ''
              ),
              {
                include_blank: true,
                class: 'stories-filter category-select form-control',
                style: 'width: 100%'
              }
            ) %>

        <span class="filter-results pull-right">
          <% if pre_selected_filters['category'].present? %>
            <%= "#{pluralize(Story.company_public_filter_category(company.id, pre_selected_filters['category']).length, 'story', 'stories')} found" %>
          <% end %>
        </span>

      </div>

    <% end %>

  <% end %>

  <% if include_product_filter?(company) %>

    <% cache(product_select_cache_key, skip_digest: true) do %>

      <div class="form-group">

        <%= label_tag(:product_select, "Product") %>
        <%= select_tag(:product_select,
              options_for_select(
                company.products.public_select_options,
                pre_selected_filters['product'].present? ? [pre_selected_filters['product']] : []
              ),
              {
                include_blank: true,
                class: 'stories-filter product-select form-control',
                style: 'width: 100%'
              }
            ) %>

        <span class="filter-results pull-right">
          <% if pre_selected_filters['product'].present? %>
            <%= "#{pluralize(Story.company_public_filter_product(company.id, pre_selected_filters['product']).length, 'story', 'stories')} found" %>
          <% end %>
        </span>

      </div>

    <% end %>

  <% end %>

</div>