.search-and-filters.visible-xs-block {
  class=('visible-sm-block' unless company.story_categories.featured.blank? && company.products.featured.blank?) }
  
  = render('stories/shared/search_form', { company:, is_header_search: false })

  - if company.story_categories.featured.present? && company.products.featured.present?
    .stories-filter.form-group
      .input-group.tom-select.multi
        span.input-group-addon
          = image_tag('icons/bs_funnel.svg', alt: 'filter')
        = select_tag( \
            :filter_select,
            grouped_options_for_select( \
              { 'Category' => company.story_categories.select_options(true, true), 
                'Product' => company.products.select_options(true, true) }.delete_if { |tag_type, options| options.blank? },
              filters.map { |tag_type, tag_id| "#{tag_type}-#{tag_id}" }),
            { class: 'stories-filter__select stories-filter__select--grouped',
              multiple: true,
              style: 'width: 100%',
              data: { \
                controller: 'tomselect',
                stories_target: 'filterSelect' } })
      .filter-results.text-right
        span.help-block

  - elsif company.story_categories.featured.present?
    = render( \
        'stories/shared/select_category', 
        { company:, 
          is_dashboard: false,
          select_id: SecureRandom.urlsafe_base64, 
          preselected_id: filters[:category] })

  - elsif company.products.featured.present?
    = render( \
        'stories/shared/select_product', 
        { company:, 
          is_dashboard: false,
          select_id: SecureRandom.urlsafe_base64, 
          preselected_id: filters[:product] })