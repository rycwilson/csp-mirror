
<table id='measure-visitors-table' width='100%'
       class="table table-striped table-bordered">

  <thead>
    <tr>
      <th>Visitor</th>
      <th>Organization</th>
      <th>Location</th>
      <th>Visits</th>
      <th>Last visited</th>
    </tr>
  </thead>

  <tfoot>
    <tr>
      <td colspan='1'><em>
        Total: <%= company.visitors.count %>
      </em></td>
      <td colspan='2'></td>
      <td colspan='1'><em>
        Total: <%= company.visitor_sessions.count %>
      </em></td>
      <td colspan='1'></td>
    </tr>
  </tfoot>

  <tbody>

    <% Visitor.includes(:visitor_sessions).company_all(company.id).each do |visitor| %>

      <tr>
        <td><%= visitor.clicky_uid %></td>
        <td><%= visitor.visitor_sessions.take.organization %></td>
        <td><%= visitor.visitor_sessions.take.location %></td>
        <td><%= visitor.visitor_sessions_count %></td>
        <td><%= visitor.visitor_sessions.order(timestamp: :desc)
                                        .take.timestamp.strftime("%-m/%-d/%y") %></td>
      </tr>

    <% end %>

  </tbody>

</table>
