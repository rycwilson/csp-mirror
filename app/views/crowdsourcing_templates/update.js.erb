
(function () {

  var company = <%= raw @company.to_json({ only: [:id] }) %>,
      contributorQuestions =
        <%= raw @template.contributor_questions
                         .to_json({ only: [:id, :company_id, :role, :question] }) %>;


  toggleFormDone($('#crowdsourcing-template-form'), true);
  $('#crowdsourcing-template-form').data('dirty', '');

  // update questions list
  $('.contributor-questions ul').empty()
    .append(
      _.template( $('#contributor-questions-template').html() )(
        { company: company, contributorQuestions: contributorQuestions }
      )
    );

  // update select options
  $('select.contributor-questions')
    .select2('destroy').empty()
    .prepend('<option selected/>')  // placeholder
    .select2({
      theme: "bootstrap",
      placeholder: 'Add a Question',
      data: <%= raw @company.contributor_questions.grouped_select2_options(@template).to_json %>
    })

}());