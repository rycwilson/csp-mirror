
(function () {

  var cta = <%= raw @cta.to_json({ methods: [:type] }) %>,
      isPrimary = <%= @is_primary %>,
      template = _.template( $('#cta-template').html() );

  if (isPrimary) {
    $('#primary-cta')
      .empty().append( template({ cta: cta, isPrimary: true }) );
    $('input[type="checkbox"][id="is_primary"]').prop('disabled', true);

  } else {
    $('#secondary-ctas').prepend( template({ cta: cta, isPrimary: false }) );
  }

  // add the form html via $.text so it's properly html-escaped
  // (the underscore template will leave the field blank)
  if (cta.type === 'CTAForm') {
    $('li[data-cta-id="' + cta.id + '"] textarea').text(cta.form_html)
  }

  // reset everything except the radio buttons (don't want toggle action)
  $('#new-cta-form').find('input, textarea').not('[name="new_cta[type]"]')
      .each(function () { this.value = this.defaultValue; })
  $('#new-cta-submit, #new-cta-reset').prop('disabled', true);

}());