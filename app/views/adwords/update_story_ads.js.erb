
(function () {

  var flash = <%= raw @flash.to_json %> ||
        { status: 'success',
            mesg: 'Sponsored Story updated' },
      storyId = <%= @story.id %>,
      $row = $('tr[data-story-id="' + storyId + '"]'),
      imageChanged = <%= @image_changed %>,
      statusChanged = <%= @status_changed %>;

  if (imageChanged) {
    var adwordsImage = <%= raw @story.ads.adwords_image.to_json %>;
    $('#adwords-image-select-modal').modal('hide')
    if ( adwordsImage && adwordsImage.image_url ) {
      $row.find('.thumbnail img').attr('src', adwordsImage.image_url)
    }
  } else if (statusChanged) {
    // handled by classes / styling
  } else {
    // long headline handled by xeditable plugin
  }

  flashDisplay(flash.mesg, flash.status);

}());