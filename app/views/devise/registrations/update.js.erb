(function () {

  var user = <%= raw @user.to_json %>,
      status = "<%= @status %>",
      flashMesg = "<%= @flash_mesg %>",
      linkedinUpdate = <%= @linkedin_update %>
      passwordUpdate = <%= @password_update %>;   // boolean

  if (passwordUpdate) {
    $('#password-update-form')[0].reset();
    if (status === 'success') {
      flashDisplay("Password updated successfully", status);
      $("[href='#profile-tab']").click()
    }
    else {
      flashDisplay(flashMesg, status);
      $('#user_current_password').focus();
    }
  }
  else {
    if (status === 'success') {
      $.getScript('http://platform.linkedin.com/in.js', function () {
        $("input[name='user[linkedin_url]']").parent().siblings().remove();
        $("input[name='user[linkedin_url]']").parent().after(
              "<script type='IN/MemberProfile' " +
                "data-id='" + user.linkedin_url + "' " +
                "data-format='inline' data-related='false' " +
                "data-width='300'>" +
              "</script>"
            );
        IN.parse();
      });
      flashDisplay("Account updated successfully", status);
    }
    else {
      flashDisplay(flashMesg, status);
    }
  }

})();