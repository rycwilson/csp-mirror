(function () {

  var status = "<%= @status %>",
      flashMesg = "<%= @flash_mesg %>"
      pwUpdate = <%= @password_update %>   // boolean

  if (pwUpdate) {
    $('#password-update-form')[0].reset();
    if (status === 'success') {
      flashDisplay("Password updated successfully", status);
      $("[href='#profile-tab']").click()
    }
    else {
      flashDisplay(flashMesg, status);
      $('#user_current_password').focus();
    }
  }
  else {
    if (status === 'success')
      flashDisplay("Account updated successfully", status);
    else
      flashDisplay(flashMesg, status);
  }

  function flashDisplay (mesg, status) {

    $('#flash').toggleClass('hidden alert-' + status).append(mesg);
    // another way:
    $('#flash').hide().append(flash).fadeIn('fast');


    setTimeout(function () {
      $('#flash').slideUp();
      // $('#send_contribution_request').parent()[0].reset()
    }, 4000);

    setTimeout(function () {
      $('#flash').toggleClass('hidden alert-' + status)
      // dispay:none setting appears after first click-cycle,
      // leads to subsequent failures
      // solution...
      $('#flash').css('display', '');
      // remove all text, leave child elements
      $('#flash').html($('#flash').children());
    }, 5000);
  }

})();