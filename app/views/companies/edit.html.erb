<div class="wrapper">

  <!-- this needs to be present despite being empty, or stuff below will go haywire -->
  <div class="mainnav">
    <div class="container">

    </div>
  </div>

  <div class="content">
    <div class="container">
      <div class="layout layout-main-right layout-stack-sm">
        <div class="col-md-3 col-sm-4 layout-sidebar">

          <ul class="nav nav-layout-sidebar nav-stacked">

            <li class="active">
              <a href="#company-profile" data-toggle="tab">
                <i class="fa fa-edit"></i>
                &nbsp;&nbsp;Company
              </a>
            </li>

            <% if @company.persisted? %>

              <li>
                <a href="#email-templates" data-toggle="tab">
                  <i class="fa fa-envelope-o"></i>
                  &nbsp;&nbsp;Email Templates
                </a>
              </li>

             <!--  <li>
                <a href="#curators" data-toggle="tab">
                  <i class="fa fa-users"></i>
                  &nbsp;&nbsp;Curators
                </a>
              </li> -->

            <% else %>

              <li>
                <a href="javascript:;" data-toggle="tab">
                  <i class="fa fa-envelope-o"></i>
                  &nbsp;&nbsp;Email Templates
                </a>
              </li>

              <!-- <li>
                <a href="javasript:;" data-toggle="tab">
                  <i class="fa fa-users"></i>
                  &nbsp;&nbsp;Curators
                </a>
              </li> -->

            <% end %>

          </ul>
        </div> <!-- /.col -->

        <div class="col-md-9 col-sm-8 layout-main">
          <div class="tab-content stacked-content">
            <div class="tab-pane fade in active" id="company-profile">

              <div class="heading-block">

                <% if @company.new_record? %>
                  <h3> Company Registration </h3>

                <% else %>
                  <h3> Company Profile </h3>

                <% end %>
              </div> <!-- /.heading-block -->

              <%= form_for @company, method: 'put', remote: true,
                    authenticity_token: true,
                    html: { class: 'directUpload',
                             data: {
                               'form-data' => (@s3_direct_post.fields),
                                     'url' => @s3_direct_post.url,
                                    'host' => URI.parse(@s3_direct_post.url).host
                                    } } do |f| %>
                <div class="col-md-5">

                  <div class="form-group required-input">
                    <%= f.label :name, class: 'control-label' %>
                    <%= f.text_field :name, class: 'form-control'%>
                  </div>

                  <div class="form-group required-input">
                    <%= f.label :subdomain, class: 'control-label' %>

                    <% if @company.persisted? %>
                      <%= f.text_field :subdomain, class: 'form-control', disabled: true %>
                    <% else %>
                      <%= f.text_field :subdomain, class: 'form-control' %>
                    <% end %>
                  </div>

                  <label>Logo</label>  <!-- have to pull this out for proper styling -->
                  <div class="form-group">

                    <div class="fileinput <%= @company.logo_url.blank? ? 'fileinput-new' : 'fileinput-exists' %>" data-provides="fileinput" style='margin:0'>

                      <div class="fileinput-new thumbnail"
                          style="width: 100px; height: 100px;">
                        <%= image_tag "company-logo-missing.png", alt: 'logo missing' %>
                      </div>

                      <div class="fileinput-preview fileinput-exists thumbnail"
                          data-trigger="fileinput"
                          style="width: 100px; height: 100px;">
                        <img src="<%= @company.logo_url %>" alt="company logo">
                      </div>

                      <div>
                        <span class="btn btn-default btn-file">
                          <span class="fileinput-new">
                            Select image
                          </span>
                          <span class="fileinput-exists">
                            Change
                          </span>
                          <%= f.file_field :logo_url %>
                        </span>

                        <a href="#" class="btn btn-default fileinput-exists" data-dismiss="fileinput">
                          Remove
                        </a>
                      </div>

                    </div> <!-- /.fileupload -->
                  </div>  <!-- form-group -->
                </div>  <!-- col -->

                <div class="col-md-7">

                  <div class="form-group">

                    <%= label_tag 'Industries served', nil, class: 'control-label' %>
                    <%= select_tag 'company_tags[industry][]',
                        options_for_select(@industries, @industries_pre_select),
                        { multiple: 'true', class: 'company-tags form-control',
                          # placeholder: doesn't work from here, set in js
                          style: 'width:100%' } %>
                  </div>

                  <div class="form-group">
                    <%= label_tag 'Product categories', nil, class: 'control-label' %>
                    <%= select_tag 'company_tags[product_category][]',
                        # none presently exist, so pass empty array...
                        options_for_select(@product_categories, @product_cats_pre_select),
                        { multiple: 'true', class: 'company-tags form-control',
                          style: 'width:100%' } %>
                  </div>

                  <div class="form-group">
                    <%= label_tag 'Products', nil, class: 'control-label' %>
                    <%= select_tag 'company_tags[product][]',
                        # none presently exist, so pass empty array...
                        options_for_select(@products, @products_pre_select),
                        { multiple: 'true', class: 'company-tags form-control',
                          style: 'width:100%' } %>
                  </div>
                </div>  <!-- col -->

                <div class="col-md-12">
                  <hr style='margin-top:0'>
                </div>

                <div class="col-md-4 col-md-offset-8 text-right">
                  <div class="form-group">
                    <input type='submit' class='btn btn-primary'
                      value="<%= @company.new_record? ? 'Register' : 'Save changes' %>">
                  <!--   </button> -->
                    &nbsp;
                    <button type="reset" class="btn btn-default">
                      Cancel
                    </button>
                  </div>
                </div>
              <% end %>  <!-- form_for -->

            </div> <!-- /.tab-pane -->

            <div class="tab-pane fade" id="email-templates">

              <div class="heading-block">
                <h3> Email Templates </h3>
              </div> <!-- /.heading-block -->

              <!-- the template id will be appended to url when selection is made -->
              <%= form_tag "/", method: :put, remote: true,
                    class: 'form-horizontal', id: 'email-template-form' do %>

                <div class="form-group">
                  <%= label_tag "Template", nil, class: "control-label col-md-2" %>
                  <div class="col-md-10">
                    <%= select_tag "template[name]",
                          options_for_select(@templates_select),
                         { class: 'templates-select form-control',
                           style: 'width:80%' } %>
                  </div>
                </div>

                <div class="form-group">
                  <%= label_tag "Subject", nil, class: "control-label col-md-2" %>
                  <div class="col-md-10">
                    <%= text_field_tag "template[subject]", nil, class: 'form-control', style:'width:80%' %>
                  </div>
                </div>

                <div class="form-group">
                  <%= label_tag "Body", nil, class: "control-label col-md-2" %>
                  <div class="col-md-10">
                    <%= text_area_tag "template[body]", nil,
                          data: { provider: 'summernote'},
                          class: 'form-control', rows: 20,
                          style: "width: 80%" %>
                  </div>
                </div>

                <div class="form-group">
                  <div class='col-md-10 text-right'>
                    <%= submit_tag "Save changes", class: "btn btn-primary" %>
                  </div>

                </div>

              <% end %>

            </div> <!-- /.tab-pane -->

            <div class="tab-pane fade" id="curators">

              <div class="heading-block">
                <h3> Add and Remove Curators </h3>
              </div> <!-- /.heading-block -->

            </div> <!-- /.tab-pane -->

          </div> <!-- /.tab-content -->
        </div> <!-- /.col -->

      </div> <!-- /.row -->
    </div>  <!-- container -->
  </div>  <!-- content -->
</div>  <!-- wrapper