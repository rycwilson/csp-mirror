
<script type='text/template' id='contributor-template'>

  {{ var AUTH_TOKEN = $('meta[name=csrf-token]').attr('content'); }}

{{ console.log(contribution) }}
  <div class="container contributor-details" style='width:100%'>

    <form id='contributor-form' class='form-horizontal' method='post'
          action='/contributions/{{= contribution.id }}'
          data-remote='true' data-type='script'>

      <input type="hidden" name="_method" value="put">
      <input type="hidden" name="authenticity_token" value="{{= AUTH_TOKEN }}">

      <div class="row">

        <div class="col-sm-6">

          <div class='form-group'>
            <label for="contributor-{{= contribution.contributor.id }}-first-name" class="col-sm-3 control-label">First name</label>
            <div class="col-sm-9">
              <input type="text" class="form-control"
                id='contributor-{{= contribution.contributor.id }}-first-name'
                name="contribution[contributor][first_name]"
                value="{{= contribution.contributor.first_name }}">
            </div>
          </div>

          <div class='form-group'>
            <label for="contributor-{{= contribution.contributor.id }}-last-name" class="col-sm-3 control-label">Last name</label>
            <div class="col-sm-9">
              <input type="text" class="form-control"
                id="contributor-{{= contribution.contributor.id }}-last-name"
                name='contribution[contributor][last_name]'
                value="{{= contribution.contributor.last_name }}">
            </div>
          </div>

          <div class='form-group'>
            <label for="contributor-{{= contribution.contributor.id }}-title" class="col-sm-3 control-label">Position</label>
            <div class="col-sm-9">
              <input type="text" class="form-control"
                id="contributor-{{= contribution.contributor.id }}-title"
                name='contribution[contributor][title]'
                value="{{= contribution.contributor.title }}">
            </div>
          </div>

          <div class='form-group'>
            <label for="contributor-{{= contribution.contributor.id }}-email" class="col-sm-3 control-label">Email</label>
            <div class="col-sm-9">
              <input type="email" class="form-control"
                id="contributor-{{= contribution.contributor.id }}-email"
                name='contribution[contributor][email]'
                value="{{= contribution.contributor.email }}">
            </div>
          </div>

          <div class='form-group'>
            <label for="contributor-{{= contribution.contributor.id }}-phone" class="col-sm-3 control-label">Phone</label>
            <div class="col-sm-9">
              <input type="tel" class="form-control"
                id="contributor-{{= contribution.contributor.id }}-phone"
                name='contribution[contributor][phone]'
                value="{{= contribution.contributor.phone }}">
            </div>
          </div>
        </div>

        <div class="col-sm-6">

          <div class='form-group'>
            <label for="contributor-{{= contribution.contributor.id }}-linkedin-url" class="col-sm-3 control-label">LinkedIn</label>
            <div class="col-sm-9">
              <input type="text" class="form-control"
                id="contributor-{{= contribution.contributor.id }}-linkedin-url"
                name='contribution[contributor][linkedin_url]'
                placeholder='Profile URL'
                value="{{= contribution.contributor.linkedin_url }}">
            </div>
          </div>

  <!-- // linkedin profile: publish checkbox and widget (or placeholder) -->

          <div class="linkedin-profile {{= contribution.contributor.linkedin_url ? '' : 'hidden' }}" >

            <!-- // don't render checkbox if still in the crowdsource stage -->
            {{ if (workflowStage === 'curate') { }}
              <!-- // tooltip wrapper -->
              <div class='form-group'
                data-toggle="{{= contribution.contributor_unpublished ? 'tooltip' : '' }}"
                data-placement="{{= contribution.contributor_unpublished ? 'top' : '' }}"
                title="{{= contribution.contributor_unpublished ? 'Contributor has removed their profile from this story' : '' }}">

                <div class="linkedin-checkbox-container {{= contribution.contributor_unpublished ? 'contributor-unpublished' : '' }}">
                  <label for='contribution-publish-contributor-{{= contribution.contributor.id }}'>
                    <input type='checkbox'
                      id='contribution-publish-contributor-{{= contribution.contributor.id }}'
                      name='contribution[publish_contributor]'
                      checked='{{= contribution.publish_contributor }}'>
                    <span>&nbsp;&nbsp;Publish profile with this Story</span>
                  </label>
                </div>

              </div>  <!-- // tooltip wrapper -->

            {{ } }}

      <!-- // profile widget -->
      <!-- // render csp widget in client so width can be determined dynamically -->
            <div class="widget-container">

              {{ if (contribution.contributor['linkedin_data?']) { }}

                <div class="csp-widget-container text-center"
                </div>

              {{ } else { }}

      <!-- // placeholder rendered, replaced if/when linkedin widget arrives -->
                <div class='placeholder-widget-container text-center'
                     style='height:128px'>
                </div>

      <!-- // widget is fetched when contributor child row is expanded -->
                <div class='linkedin-widget-container hidden text-center'
                     style='position:relative'>
                </div>

              {{ } }}

            </div>  <!-- // .widget-container -->
          </div>  <!-- // .linkedin-profile -->

        </div>

      </div>

      <hr>

      <div class="row">
        <div class="col-sm-12 text-right">
          <button type="reset" class="btn btn-sm btn-default">
            Cancel
          </button>
          <button type="submit" class="btn btn-sm btn-success text-center">
            <span>Save changes</span>
            <i class='fa fa-spinner fa-pulse' style='display:none'></i>
            <i class='fa fa-check' style='display:none'></i>
          </button>&nbsp;
        </div>
      </div>

    </form>

  </div>

</script>