
// TODO: make sure all of this only runs once (i.e. page refresh)

(function () {

  var contributionsInProgress = <%= raw @contributions_in_progress.to_json %>,
      contribution = <%= raw @contribution.to_json %>,
         flashMesg = "<%= @flash_mesg %>",
       flashStatus = "<%= @flash_status %>",
          template = _.template($('#in-progress-template').html());

  flashDisplay(flashMesg, flashStatus);

  if (flashStatus === "info") {  // success
    removeContributionCard(contribution.id);
    $('#in-progress-contributors')
        .empty()
        .append(template({ contributions: contributionsInProgress }));
    $('.best_in_place').best_in_place();
  }

  // remove the pre-request contribution card
  function removeContributionCard (contribution_id) {
    var $preRequestCard = $('#pre-request')
          .find("div[data-contribution-id='" + contribution_id.toString() + "']");
    setTimeout(function () {
      $preRequestCard.hide('fast', function() { $preRequestCard.remove(); });
      // $('#flash').fadeOut(300, function () { $(this).remove() });
    }, 3500);
  }

}());









