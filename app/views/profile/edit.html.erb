<% content_for(:head) do %>
  <!-- LI widget won't load if page is cached -->
  <meta name="turbolinks-cache-control" content="no-cache">
<% end %>

<%= render(
      'shared/navbars/company_nav', 
      { company: @company, workflow_stage: nil }
    ) %>

<div class="container">
  <div class="row">

    <div class="col-sm-4 col-lg-3 layout-sidebar">

      <ul class="nav">
        <li class="active">
          <a href="#profile-tab" data-toggle="tab">
            <i class="fa fa-fw fa-user"></i>
            <span>Profile</span>
          </a>
        </li>
        <li>
          <a href="#password-tab" data-toggle="tab">
            <i class="fa fa-fw fa-lock"></i>
            <span>Change Password</span>
          </a>
        </li>
      </ul>

      <% if current_user.admin? || @original_user.try(:admin?) %>

        <div style="display: flex; justify-content: center">
          <div id="switch-user" class="dropdown">
            <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
              Switch User
              <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" aria-labelledby="switch-user">
              <% @switch_users.each do |user| %>
                <li>
                  <%= form_tag(switch_user_path, method: 'POST', remote: true) do %>
                    <%= hidden_field_tag(:switch_user_id, user[:id]) %>
                    <%= submit_tag(user[:name], style: 'background: none; border: none') %>
                  <% end %>
                </li>
              <% end %>
            </ul>
          </div>
        </div>

      <% end %>

    </div>

    <div class="col-sm-8 col-lg-9 layout-main">
      <div class="tab-content">
        <div class="tab-pane fade in active" id="profile-tab">

          <%= render(
                'profile/user_profile', 
                { user: @user, s3_direct_post: @s3_direct_post }
              ) %>

        </div>
        <div class="tab-pane fade in active" id="password-tab">

        </div>
      </div>
    </div>

  </div>
</div>
