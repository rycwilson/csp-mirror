
(function () {

  var success = <%= raw @success.to_json(only: [:id], include: { contributors: { only: [:id] } }) %>
  if (success.contributors) {
    $('#prospect-contributors-table').DataTable().ajax.reload();
    $('#prospect-contributors-table').closest('[id*="table_wrapper')
      .find('.curator-select').trigger('change')
  }

  $('#successes-table').DataTable()
    .ajax.reload(function (successes) {

      var $trSuccess = $('tr[data-success-id="' + success.id + '"]'),
          $trGroup = $trSuccess.prev(),
          openSuccessDetails = function () {
            $trSuccess.find('.success-details').trigger('click');
          }

      $('#new-success-modal').modal('hide');

      // ref: https://stackoverflow.com/questions/6677035
      $('html body').animate({
        scrollTop: $trGroup.offset().top
      }, 400, 'swing', openSuccessDetails);

    })

}());